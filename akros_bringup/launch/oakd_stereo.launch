<?xml version="1.0"?>
<launch>

    <!-- ARGUMENTS - LAUNCH FILE -->
    <arg name="nodelet" default="true"/>
 
    <!-- ARGUMENTS - OAKD CAMERA PARAMS -->
    <arg name="camera_name"  default="oakd" />
    <arg name="camera_param_uri" default="package://depthai_nodes/params/camera" />
    
    <!-- ARGUMENTS - OAKD NODE/NODELET -->
    <arg name="mode"     default="depth" />
    <arg name="lrcheck"  default="true" /> 
    <arg name="extended" default="false" /> 
    <arg name="subpixel" default="false" />
    
    <!-- OAKD RGB + DEPTH/DISPARITY + L/R MONO NODELET -->
    <group if="$(arg nodelet)">
        <node pkg="nodelet" type="nodelet" name="nodelet_manager"  args="manager" output="screen"/>

        <node name="stereo_pub" pkg="nodelet" type="nodelet" output="screen" required="true"
            args="load depthai_nodes/stereo_nodelet nodelet_manager">
            <param name="camera_name" value="$(arg camera_name)"/>
            <param name="camera_param_uri" value="$(arg camera_param_uri)"/>
            <param name="mode" value="$(arg mode)"/>
            <param name="lrcheck" value="$(arg lrcheck)"/>
            <param name="extended" value="$(arg extended)"/>
            <param name="subpixel" value="$(arg subpixel)"/>
        </node>   
    </group>

    <!-- OAKD RGB + DEPTH/DISPARITY + L/R MONO NODE -->
    <group unless="$(arg nodelet)">
        <!-- launch-prefix="xterm -e gdb (add [- - args] without space) -->
        <node name="stereo_pub" pkg="depthai_nodes" type="stereo_node" output="screen" required="true">
            <param name="camera_name" value="$(arg camera_name)"/>
            <param name="camera_param_uri" value="$(arg camera_param_uri)"/>
            <param name="mode" value="$(arg mode)"/>
            <param name="lrcheck" value="$(arg lrcheck)"/>
            <param name="extended" value="$(arg extended)"/>
            <param name="subpixel" value="$(arg subpixel)"/>
        </node>     
    </group>

</launch>